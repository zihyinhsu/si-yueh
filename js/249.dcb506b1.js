"use strict";(self["webpackChunksi_yueh"]=self["webpackChunksi_yueh"]||[]).push([[249],{6614:function(t,e,a){a.d(e,{Z:function(){return w}});var s=a(6252),l=a(3577),o=a(9963);const i={"aria-label":"Page navigation"},d={class:"pagination d-flex align-items-center"},r=(0,s._)("span",{"aria-hidden":"true"},"«",-1),n=[r],c=["onClick"],p=(0,s._)("span",{"aria-hidden":"true"},"»",-1),u=[p];function g(t,e,a,r,p,g){return(0,s.wg)(),(0,s.iD)("nav",i,[(0,s._)("ul",d,[(0,s._)("li",{class:(0,l.C_)(["page-item",{disabled:!a.pages.has_pre}])},[(0,s._)("a",{class:"page-link",href:"#","aria-label":"Previous",onClick:e[0]||(e[0]=(0,o.iM)((e=>(t.$emit("update-page",a.pages.category,a.pages.current_page-1),g.goTop())),["prevent"]))},n)],2),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(a.pages.total_pages,((e,i)=>((0,s.wg)(),(0,s.iD)("li",{class:(0,l.C_)(["page-item",{active:e===a.pages.current_page}]),key:i},[(0,s._)("a",{class:(0,l.C_)(["page-link",{"pointer-none":e===a.pages.current_page}]),href:"#",onClick:(0,o.iM)((s=>(t.$emit("update-page",a.pages.category,e),g.goTop())),["prevent"])},(0,l.zw)(e),11,c)],2)))),128)),(0,s._)("li",{class:(0,l.C_)(["page-item",{disabled:!a.pages.has_next}])},[(0,s._)("a",{class:"page-link",href:"#","aria-label":"Next",onClick:e[1]||(e[1]=(0,o.iM)((e=>(t.$emit("update-page",a.pages.category,a.pages.current_page+1),g.goTop())),["prevent"]))},u)],2)])])}var m={props:["pages"],methods:{goTop(){document.documentElement.scrollTop=0}}},h=a(3744);const _=(0,h.Z)(m,[["render",g]]);var w=_},6249:function(t,e,a){a.r(e),a.d(e,{default:function(){return Ht}});var s=a(6252),l=a(3577),o=a(9963),i=a(9163);const d=(0,s._)("img",{src:i,alt:"Loading"},null,-1),r=(0,s._)("div",{class:"d-flex mb-4"},[(0,s._)("h2",{class:"category bg-white text-primaryDark fw-bold fs-3 me-4 p-2"},"# 後台訂單管理")],-1),n={class:"overflow-auto vh-70 mb-5"},c={class:"table caption-top table-hover text-primaryDark"},p=(0,s._)("thead",null,[(0,s._)("tr",null,[(0,s._)("th",{scope:"col"},"購買時間"),(0,s._)("th",{scope:"col"},"Email"),(0,s._)("th",{scope:"col"},"購買款項"),(0,s._)("th",{scope:"col"},"應付金額"),(0,s._)("th",{scope:"col"},"是否付款"),(0,s._)("th",{scope:"col"},"編輯/刪除")])],-1),u={class:"list-unstyled"},g={class:"fw-bold"},m={class:"ps-5"},h={class:"switch"},_=["onUpdate:modelValue","onChange"],w=(0,s._)("span",{class:"slider"},null,-1),f={class:"d-flex"},y=["onClick"],x=(0,s._)("i",{class:"fa-solid fa-pencil cursor-pointer text-primary fs-4 me-6"},null,-1),b=[x],D=["onClick"],v=(0,s._)("i",{class:"fa-solid fa-trash cursor-pointer text-primary fs-4"},null,-1),k=[v];function M(t,e,a,i,x,v){const M=(0,s.up)("LoadingView"),z=(0,s.up)("OrderModal"),$=(0,s.up)("DelModal"),C=(0,s.up)("PagiNation");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(M,{class:"loading",active:x.isLoading},{default:(0,s.w5)((()=>[d])),_:1},8,["active"]),r,(0,s._)("div",n,[(0,s._)("table",c,[p,(0,s._)("tbody",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(x.orders,(e=>((0,s.wg)(),(0,s.iD)("tr",{key:e.id},[(0,s._)("td",null,(0,l.zw)(t.$filters.date(e.create_at)),1),(0,s._)("td",null,(0,l.zw)(e.user.email),1),(0,s._)("td",null,[(0,s._)("ul",u,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.products,((t,e)=>((0,s.wg)(),(0,s.iD)("li",{key:e},[(0,s._)("span",g,(0,l.zw)(t.product.title),1),(0,s.Uk)(" / "+(0,l.zw)(t.qty)+" "+(0,l.zw)(t.product.unit),1)])))),128))])]),(0,s._)("td",null,"NT$ "+(0,l.zw)(Math.round(e.total)),1),(0,s._)("td",m,[(0,s._)("label",h,[(0,s.wy)((0,s._)("input",{type:"checkbox","onUpdate:modelValue":t=>e.is_paid=t,onChange:t=>v.updatePaid(e)},null,40,_),[[o.e8,e.is_paid]]),w])]),(0,s._)("td",null,[(0,s._)("div",f,[(0,s._)("div",{class:"editBtn d-flex align-items-center",onClick:t=>v.openModal("edit",e)},b,8,y),(0,s._)("div",{class:"delBtn d-flex align-items-center",onClick:t=>v.openModal("delete",e)},k,8,D)])])])))),128))])])]),(0,s.Wm)(z,{ref:"orderModal",temp:x.temp,onUpdateOrders:v.updatePaid},null,8,["temp","onUpdateOrders"]),(0,s.Wm)($,{ref:"delModal",temp:x.temp,onDelItem:v.delOrderItem},null,8,["temp","onDelItem"]),(0,s.Wm)(C,{class:"d-flex justify-content-center",pages:x.pagination,onUpdatePage:v.getOrders},null,8,["pages","onUpdatePage"])],64)}var z=a(8262),$=a(6294),C=a(6614);const L={class:"modal fade",ref:"modal",tabindex:"-1"},O={class:"modal-dialog modal-dialog-centered modal-lg"},U={class:"modal-content background-transparent"},P={class:"modal-header bg-primary text-center p-3"},T={class:"modal-title text-white"},Z=(0,s.uE)('<option selected value="">配送進度</option><option value="已收到訂單">已收到訂單</option><option value="準備出貨中">準備出貨中</option><option value="包裹已送達物流中心，正在理貨中">包裹已送達物流中心，正在理貨中</option><option value="包裹進行配送中">包裹進行配送中</option><option value="商品已送達指定地點，請前去領取">商品已送達指定地點，請前去領取</option>',6),N=[Z],q={class:"modal-body bg-white text-center p-6"},H={class:"row"},V={class:"col-5"},Y={class:"position-sticky top-20"},E={class:"d-flex justify-content-between align-items-center mb-5"},I=(0,s._)("p",{class:"bg-light text-primary fw-bold fs-3 p-2"},"# 用戶資訊",-1),K={class:"d-flex"},S={key:0,class:"text-secondary fw-bold me-2"},W={key:1,class:"text-secondary fw-bold me-2"},j={class:"switch"},B=(0,s._)("span",{class:"slider"},null,-1),A={class:"table table-sm"},F={class:"text-start"},G=(0,s._)("th",{class:"text-secondaryDark",scope:"row"},"下單時間",-1),J={class:"text-secondaryDark"},Q={class:"text-start"},R=(0,s._)("th",{class:"text-secondaryDark",scope:"row"},"Email",-1),X={class:"text-secondaryDark"},tt={class:"text-start"},et=(0,s._)("th",{class:"text-secondaryDark",scope:"row"},"收件人姓名",-1),at={class:"text-secondaryDark"},st={class:"text-start"},lt=(0,s._)("th",{class:"text-secondaryDark",scope:"row"},"電話號碼",-1),ot={class:"text-secondaryDark"},it={class:"text-start"},dt=(0,s._)("th",{class:"text-secondaryDark",scope:"row"},"收件地址",-1),rt={class:"text-secondaryDark"},nt={key:0,class:"text-start"},ct=(0,s._)("th",{class:"text-secondaryDark",scope:"row"},"付款方式",-1),pt={class:"text-secondaryDark"},ut={key:1,class:"text-start"},gt=(0,s._)("th",{class:"text-secondaryDark",scope:"row"},"備註",-1),mt={class:"text-secondaryDark"},ht={class:"col-6 offset-1"},_t=(0,s._)("div",{class:"d-flex mb-4"},[(0,s._)("p",{class:"bg-light text-primary fw-bold fs-3 p-2"},"# 訂單內容")],-1),wt={class:"d-flex align-items-center"},ft=["src","alt"],yt={class:"cart-body text-start"},xt={class:"fw-bold"},bt={class:"fw-bold"},Dt={class:"fw-bold text-primaryDark"},vt={key:0,class:"text-danger fw-bold"},kt={class:"w-25 w-md-20"},Mt={class:"fs-4 fw-bold text-end"},zt={class:"modal-footer border-0 bg-white flex-nowrap w-100"},$t=(0,s._)("button",{type:"button",class:"btn btn-outline-primary","data-bs-dismiss":"modal"},"取消",-1);function Ct(t,e,a,i,d,r){return(0,s.wg)(),(0,s.iD)("div",L,[(0,s._)("div",O,[(0,s._)("div",U,[(0,s._)("div",P,[(0,s._)("h4",T,"訂單編號 : "+(0,l.zw)(t.tempModalData.id),1),(0,s.wy)((0,s._)("select",{class:"form-select form-select-sm bg-light box-shadow-none w-auto","onUpdate:modelValue":e[0]||(e[0]=e=>t.tempModalData.orderStatus=e)},N,512),[[o.bM,t.tempModalData.orderStatus]])]),(0,s._)("div",q,[(0,s._)("div",H,[(0,s._)("div",V,[(0,s._)("div",Y,[(0,s._)("div",E,[I,(0,s._)("div",K,[t.tempModalData.is_paid?((0,s.wg)(),(0,s.iD)("span",S,"已付款")):((0,s.wg)(),(0,s.iD)("span",W,"未付款")),(0,s._)("label",j,[(0,s.wy)((0,s._)("input",{type:"checkbox","onUpdate:modelValue":e[1]||(e[1]=e=>t.tempModalData.is_paid=e)},null,512),[[o.e8,t.tempModalData.is_paid]]),B])])]),(0,s._)("table",A,[(0,s._)("tbody",null,[(0,s._)("tr",F,[G,(0,s._)("td",J,(0,l.zw)(this.$filters.date(t.tempModalData.create_at)),1)]),(0,s._)("tr",Q,[R,(0,s._)("td",X,(0,l.zw)(t.tempModalData.user?.email),1)]),(0,s._)("tr",tt,[et,(0,s._)("td",at,(0,l.zw)(t.tempModalData.user?.name),1)]),(0,s._)("tr",st,[lt,(0,s._)("td",ot,(0,l.zw)(t.tempModalData.user?.tel),1)]),(0,s._)("tr",it,[dt,(0,s._)("td",rt,(0,l.zw)(t.tempModalData.user?.address),1)]),t.tempModalData.user?.payment?((0,s.wg)(),(0,s.iD)("tr",nt,[ct,(0,s._)("td",pt,(0,l.zw)(t.tempModalData.user?.payment),1)])):(0,s.kq)("",!0),t.tempModalData.message?((0,s.wg)(),(0,s.iD)("tr",ut,[gt,(0,s._)("td",mt,(0,l.zw)(t.tempModalData.message),1)])):(0,s.kq)("",!0)])])])]),(0,s._)("div",ht,[_t,(0,s._)("ul",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(t.tempModalData.products,(t=>((0,s.wg)(),(0,s.iD)("li",{class:"d-flex justify-content-between align-items-center py-2",key:t.id},[(0,s._)("div",wt,[(0,s._)("img",{class:"ratio ratio-3x4 rounded-4 w-15 me-4",src:t.product.imageUrl,alt:t.product.title},null,8,ft),(0,s._)("div",yt,[(0,s._)("p",xt,(0,l.zw)(t.product.title),1),(0,s._)("p",bt,(0,l.zw)(t.product.author),1),(0,s._)("p",Dt,"NT$ "+(0,l.zw)(Math.round(t.final_total)),1),t.coupon?((0,s.wg)(),(0,s.iD)("p",vt,"已套用優惠券")):(0,s.kq)("",!0)])]),(0,s._)("p",kt,"x "+(0,l.zw)(t.qty),1)])))),128))]),(0,s._)("p",Mt," 總計金額:NT$"+(0,l.zw)(Math.round(t.tempModalData.total)),1)])])]),(0,s._)("div",zt,[$t,(0,s._)("button",{type:"button",class:"btn btn-primary text-white",onClick:e[2]||(e[2]=e=>t.$emit("update-orders",t.tempModalData))},"修改付款狀態")])])])],512)}var Lt=a(1339),Ot={mixins:[Lt.Z],watch:{temp:{handler(){this.tempModalData.orderStatus||(this.tempModalData.orderStatus="已收到訂單")},deep:!0}}},Ut=a(3744);const Pt=(0,Ut.Z)(Ot,[["render",Ct]]);var Tt=Pt,Zt=a(6354),Nt={data(){return{temp:[],orders:[],pagination:[],isLoading:!1}},components:{PagiNation:C.Z,OrderModal:Tt,DelModal:Zt.Z},methods:{...(0,z.nv)($.Z,["pushMsg"]),getOrders(t=null,e=1){this.isLoading=!0,this.$http.get(`https://vue3-course-api.hexschool.io/v2/api/zy123/admin/orders?page=${e}`).then((t=>{this.orders=t.data.orders,this.pagination=t.data.pagination,this.isLoading=!1})).catch((()=>{this.isLoading=!1}))},openModal(t,e){"edit"===t?(this.temp={...e},this.$refs.orderModal.openModal()):"delete"===t&&(this.temp={...e},this.$refs.delModal.openModal())},updatePaid(t){this.temp=t,this.isLoading=!0,this.$http.put(`https://vue3-course-api.hexschool.io/v2/api/zy123/admin/order/${t.id}`,{data:this.temp}).then((t=>{this.pushMsg(t,"更新","已成功更新付款狀態"),this.isLoading=!1,this.$refs.orderModal.hideModal(),this.getOrders()})).catch((()=>{this.pushMsg(!1,"更新","更新付款狀態失敗"),this.isLoading=!1}))},delOrderItem(t){this.isLoading=!0,this.$http.delete(`https://vue3-course-api.hexschool.io/v2/api/zy123/admin/order/${t.id}`).then((t=>{this.pushMsg(t,"更新","已成功刪除訂單"),this.isLoading=!1,this.$refs.delModal.hideModal(),this.getOrders()})).catch((()=>{this.pushMsg(!1,"更新","刪除訂單失敗"),this.isLoading=!1}))}},mounted(){this.getOrders()}};const qt=(0,Ut.Z)(Nt,[["render",M]]);var Ht=qt}}]);
//# sourceMappingURL=249.dcb506b1.js.map