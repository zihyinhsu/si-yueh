"use strict";(self["webpackChunksi_yueh"]=self["webpackChunksi_yueh"]||[]).push([[349],{4349:function(t,a,e){e.d(a,{Z:function(){return P}});var l=e(6252),s=e(3577);const r={class:"container"},o={class:"row justify-content-center"},i={class:"col-md-6 py-5 py-md-8"},n={class:"row justify-content-between"},d={class:"col-4 col-md-2"},c=(0,l.Uk)("step "),m=(0,l._)("br",null,null,-1),u=(0,l.Uk)(" 1"),p=[c,m,u],f=(0,l._)("p",{class:"fw-bold text-primary text-center"},"建立訂單",-1),b={class:"col-4 col-md-2"},_=(0,l.Uk)("step"),w=(0,l._)("br",null,null,-1),y=(0,l.Uk)(" 2"),h=[_,w,y],g=(0,l._)("p",{class:"fw-bold text-primary text-center"},"確認付款",-1),v={class:"col-4 col-md-2"},x=(0,l.Uk)("step"),k=(0,l._)("br",null,null,-1),D=(0,l.Uk)(" 3"),C=[x,k,D],V=(0,l._)("p",{class:"fw-bold text-primary text-center"},"完成訂單",-1);function U(t,a,e,c,m,u){return(0,l.wg)(),(0,l.iD)("div",r,[(0,l._)("div",o,[(0,l._)("div",i,[(0,l._)("div",n,[(0,l._)("div",d,[(0,l._)("p",{class:(0,s.C_)(["text-white text-center fw-bold p-2 mb-2",e.cartData?"bg-primary box-shadow":"bg-primaryLight"])},p,2),f]),(0,l._)("div",b,[(0,l._)("p",{class:(0,s.C_)(["text-white text-center fw-bold p-2 mb-2",e.orderId?"bg-primary box-shadow":"bg-primaryLight"])},h,2),g]),(0,l._)("div",v,[(0,l._)("p",{class:(0,s.C_)(["text-white text-center fw-bold p-2 mb-2",e.orderIsPaid?"bg-primary box-shadow":"bg-primaryLight"])},C,2),V])])])])])}var q={props:["cartData","orderIsPaid","orderId"]},W=e(3744);const I=(0,W.Z)(q,[["render",U]]);var P=I},7330:function(t,a,e){e.r(a),e.d(a,{default:function(){return Ct}});var l=e(6252),s=e(3577),r=e(9963),o=e(9163);const i=t=>((0,l.dD)("data-v-39859e87"),t=t(),(0,l.Cn)(),t),n=i((()=>(0,l._)("img",{src:o,alt:"Loading"},null,-1))),d={class:"bg-light"},c={class:"container pt-4 pb-7 pb-md-9"},m={class:"row justify-content-center"},u={class:"col-md-4 pb-4"},p=i((()=>(0,l._)("h2",{class:"bg-white category fs-4 fs-md-3 d-inline-block text-primaryDark p-2 fw-bold mb-6"},"# 確認訂單",-1))),f={key:0,class:"w-100 d-flex flex-column align-items-center py-5"},b=i((()=>(0,l._)("i",{class:"fa-solid fa-triangle-exclamation text-primaryDark fa-2x mb-3"},null,-1))),_=i((()=>(0,l._)("p",{class:"fw-bold mb-4"},"購書車內還沒有商品呢 ~",-1))),w=(0,l.Uk)("查找書籍 "),y=i((()=>(0,l._)("i",{class:"fa-solid fa-book-open-reader ms-2"},null,-1))),h={class:"d-flex align-items-center w-100"},g=["src","alt"],v={class:"cart-body w-100 me-4"},x={class:"fw-bold"},k={key:0,class:"text-danger fw-bold fs-small"},D={class:"fw-bold text-primaryDark"},C={key:0,class:"text-danger fs-small"},V={class:"input-group"},U={class:"input-group w-md-75"},q=["onClick"],W=i((()=>(0,l._)("i",{class:"fa-solid fa-minus"},null,-1))),I=[W],P=["max","onUpdate:modelValue","onChange"],E=["onClick"],S=i((()=>(0,l._)("i",{class:"fa-solid fa-plus text-white"},null,-1))),L=[S],M=["onClick"],Z=i((()=>(0,l._)("i",{class:"fa-solid fa-trash text-secondary cursor-pointer"},null,-1))),$=[Z],z={class:"p-3"},N={class:"input-group mb-3"},T={key:0,type:"text",class:"form-control",placeholder:"已套用優惠券",disabled:""},j=(0,l.Uk)(" 小計 : "),R={class:"text-primary fw-bold"},O={key:0,class:"text-end text-danger mb-3 fw-bold"},A={key:1,class:"text-secondaryDark fw-bold text-end mb-3 fs-md-4"},H={class:"col-md-5 offset-md-1"},J=i((()=>(0,l._)("h2",{class:"bg-light category fs-4 fs-md-3 d-inline-block text-primaryDark p-2 fw-bold mb-6"},"# 訂購人資料",-1))),Y={class:"mb-3"},F=i((()=>(0,l._)("label",{for:"Email",class:"form-label fw-bold"},[(0,l.Uk)("Email"),(0,l._)("span",{class:"text-danger"},"*")],-1))),K={class:"d-flex"},B={class:"mb-3 me-4"},G=i((()=>(0,l._)("label",{for:"name",class:"form-label fw-bold"},[(0,l.Uk)("訂購人姓名"),(0,l._)("span",{class:"text-danger"},"*")],-1))),Q={class:"mb-3"},X=i((()=>(0,l._)("label",{for:"tel",class:"form-label fw-bold"},[(0,l.Uk)("訂購人電話"),(0,l._)("span",{class:"text-danger"},"*")],-1))),tt={class:"mb-3"},at=i((()=>(0,l._)("label",{for:"payment",class:"form-label fw-bold"},[(0,l.Uk)("付款方式"),(0,l._)("span",{class:"text-danger"},"*")],-1))),et=i((()=>(0,l._)("option",{value:""},"選擇付款方式",-1))),lt=i((()=>(0,l._)("option",{value:"信用卡付款"},"信用卡付款",-1))),st=i((()=>(0,l._)("option",{value:"ATM轉帳付款"},"ATM轉帳付款",-1))),rt={class:"mb-3"},ot=i((()=>(0,l._)("label",{for:"address",class:"form-label fw-bold"},[(0,l.Uk)("訂購人地址"),(0,l._)("span",{class:"text-danger"},"*")],-1))),it={class:"mb-3"},nt=i((()=>(0,l._)("label",{for:"message",class:"form-label fw-bold"},"備註",-1))),dt={class:"text-end"},ct={key:0},mt={class:"container d-flex justify-content-between align-items-center"},ut=i((()=>(0,l._)("h2",{class:"category bg-white fs-4 fs-md-3 d-inline-block text-primaryDark p-2 fw-bold"},"# 最近瀏覽",-1))),pt=i((()=>(0,l._)("i",{class:"fa-solid fa-trash text-white me-2"},null,-1))),ft=(0,l.Uk)("清除瀏覽紀錄 "),bt=[pt,ft];function _t(t,a,e,o,i,W){const S=(0,l.up)("LoadingView"),Z=(0,l.up)("OrderNav"),pt=(0,l.up)("router-link"),ft=(0,l.up)("field-view"),_t=(0,l.up)("error-message"),wt=(0,l.up)("form-view"),yt=(0,l.up)("SwiperComponent");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l.Wm)(S,{class:"loading",active:t.isLoading},{default:(0,l.w5)((()=>[n])),_:1},8,["active"]),(0,l._)("div",d,[(0,l.Wm)(Z,{cartData:t.cartData},null,8,["cartData"]),(0,l._)("div",c,[(0,l._)("div",m,[(0,l._)("div",u,[p,0===t.cartData.carts.length?((0,l.wg)(),(0,l.iD)("div",f,[b,_,(0,l.Wm)(pt,{class:"btn btn-primaryDark",to:"/search"},{default:(0,l.w5)((()=>[w,y])),_:1})])):(0,l.kq)("",!0),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.cartData.carts,(a=>((0,l.wg)(),(0,l.iD)("li",{class:"d-flex justify-content-between align-items-center border-bottom-1 p-3",key:a.id},[(0,l._)("div",h,[(0,l.Wm)(pt,{class:"rounded-1 overflow-hidden me-2 cursor-pointer w-30",to:`/product/${a.product.id}`},{default:(0,l.w5)((()=>[(0,l._)("img",{class:"ratio ratio-3x4",src:a.product.imageUrl,alt:a.product.title},null,8,g)])),_:2},1032,["to"]),(0,l._)("div",v,[(0,l._)("p",x,(0,s.zw)(a.product.title),1),a.coupon?((0,l.wg)(),(0,l.iD)("p",k,"已套用優惠券")):(0,l.kq)("",!0),(0,l._)("p",D,[(0,l.Uk)("NT$ "+(0,s.zw)(a.product.price)+" ",1),a.qty>=a.product.inventory?((0,l.wg)(),(0,l.iD)("span",C,"選取已達上限")):(0,l.kq)("",!0)]),(0,l._)("div",V,[(0,l._)("div",U,[(0,l._)("button",{class:(0,s.C_)(["btn btn-outline-primary minus fs-small",{disabled:a.qty<=1}]),type:"button",onClick:e=>t.updateCart(a,a.qty--)},I,10,q),(0,l.wy)((0,l._)("input",{type:"number",class:"form-control text-center box-shadow-none fs-small",min:"1",max:a.product.inventory,"onUpdate:modelValue":t=>a.qty=t,onChange:e=>t.updateCart(a),readonly:""},null,40,P),[[r.nr,a.qty,void 0,{lazy:!0}]]),(0,l._)("button",{class:(0,s.C_)(["btn btn-primary plus fs-small",{disabled:a.qty>=a.product.inventory}]),type:"button",onClick:e=>t.updateCart(a,a.qty++)},L,10,E)])])])]),(0,l._)("div",{class:"delCartItem",onClick:e=>t.delCartItem(a)},$,8,M)])))),128)),(0,l.wy)((0,l._)("div",z,[(0,l._)("div",N,[t.cartData.final_total!==t.cartData.total?((0,l.wg)(),(0,l.iD)("input",T)):(0,l.wy)(((0,l.wg)(),(0,l.iD)("input",{key:1,type:"text",class:"form-control",placeholder:"輸入優惠券","onUpdate:modelValue":a[0]||(a[0]=a=>t.coupon_code=a),"aria-label":"coupon","aria-describedby":"coupon"},null,512)),[[r.nr,t.coupon_code]]),(0,l._)("button",{class:(0,s.C_)(["btn btn-primary text-white",{disabled:t.cartData.final_total!==t.cartData.total}]),type:"button",id:"coupon",onClick:a[1]||(a[1]=(...a)=>t.addCouponCode&&t.addCouponCode(...a))},"套用優惠券",2)]),(0,l._)("p",{class:(0,s.C_)(["text-end",{"mb-3":t.cartData.final_total!==t.cartData.total}])},[j,(0,l._)("span",R,"NT$ "+(0,s.zw)(t.cartData.total),1)],2),t.cartData.final_total!==t.cartData.total?((0,l.wg)(),(0,l.iD)("p",O,"折扣 : "+(0,s.zw)(i.discount_price),1)):(0,l.kq)("",!0),t.cartData.final_total!==t.cartData.total?((0,l.wg)(),(0,l.iD)("p",A," 折扣價 : NT$"+(0,s.zw)(i.final_total),1)):(0,l.kq)("",!0)],512),[[r.F8,t.cartData.carts.length]])]),(0,l._)("div",H,[(0,l.Wm)(wt,{ref:"form",class:"bg-white p-4 p-md-8"},{default:(0,l.w5)((({errors:t})=>[J,(0,l._)("div",Y,[F,(0,l.Wm)(ft,{id:"Email",name:"Email",type:"Email",class:(0,s.C_)(["form-control",{"is-invalid":t["Email"]}]),rules:"required",placeholder:"請輸入 Email",modelValue:i.form.user.email,"onUpdate:modelValue":a[2]||(a[2]=t=>i.form.user.email=t)},null,8,["class","modelValue"]),(0,l.Wm)(_t,{name:"Email",class:"invalid-feedback text-start"})]),(0,l._)("div",K,[(0,l._)("div",B,[G,(0,l.Wm)(ft,{id:"name",name:"姓名",type:"text",class:(0,s.C_)(["form-control",{"is-invalid":t["姓名"]}]),placeholder:"請輸入姓名",rules:"required",modelValue:i.form.user.name,"onUpdate:modelValue":a[3]||(a[3]=t=>i.form.user.name=t)},null,8,["class","modelValue"]),(0,l.Wm)(_t,{name:"姓名",class:"invalid-feedback"})]),(0,l._)("div",Q,[X,(0,l.Wm)(ft,{id:"tel",name:"電話",type:"text",class:(0,s.C_)(["form-control",{"is-invalid":t["電話"]}]),placeholder:"請輸入電話",rules:W.isPhone,modelValue:i.form.user.tel,"onUpdate:modelValue":a[4]||(a[4]=t=>i.form.user.tel=t)},null,8,["class","rules","modelValue"]),(0,l.Wm)(_t,{name:"電話",class:"invalid-feedback"})])]),(0,l._)("div",tt,[at,(0,l.Wm)(ft,{id:"payment",name:"付款方式",as:"select",class:(0,s.C_)(["form-control",{"is-invalid":t["付款方式"]}]),rules:"required",placeholder:"請輸入付款方式",modelValue:i.form.user.payment,"onUpdate:modelValue":a[5]||(a[5]=t=>i.form.user.payment=t)},{default:(0,l.w5)((()=>[et,lt,st])),_:2},1032,["class","modelValue"]),(0,l.Wm)(_t,{name:"付款方式",class:"invalid-feedback text-start"})]),(0,l._)("div",rt,[ot,(0,l.Wm)(ft,{id:"address",name:"地址",type:"text",class:(0,s.C_)(["form-control",{"is-invalid":t["地址"]}]),placeholder:"請輸入地址",rules:"required",modelValue:i.form.user.address,"onUpdate:modelValue":a[6]||(a[6]=t=>i.form.user.address=t)},null,8,["class","modelValue"]),(0,l.Wm)(_t,{name:"地址",class:"invalid-feedback"})]),(0,l._)("div",it,[nt,(0,l.wy)((0,l._)("textarea",{id:"message",class:"form-control min-h-25","onUpdate:modelValue":a[7]||(a[7]=t=>i.form.message=t)},null,512),[[r.nr,i.form.message]])]),(0,l._)("div",dt,[(0,l._)("button",{type:"submit",class:"btn btn-primary text-white w-100",onClick:a[8]||(a[8]=(0,r.iM)(((...t)=>W.onSubmit&&W.onSubmit(...t)),["prevent"]))},"送出訂單")])])),_:1},512)])])]),i.resentlyViewdProducts.length>0?((0,l.wg)(),(0,l.iD)("div",ct,[(0,l._)("div",mt,[ut,(0,l._)("div",{class:"btn btn-primary text-white",onClick:a[9]||(a[9]=(...t)=>W.clearRecentlyViewed&&W.clearRecentlyViewed(...t))},bt)]),(0,l.Wm)(yt,{category:"最近瀏覽",titlebgColor:!0,showTitle:!1})])):(0,l.kq)("",!0)])],64)}var wt=e(4349),yt=e(3661),ht=e(8262),gt=e(4677),vt=e(6294),xt={data(){return{final_total:"",discount_price:"",form:{user:{payment:"",name:"",email:"",tel:"",address:""},message:""},orderId:this.$route.params.id,resentlyViewdProducts:JSON.parse(localStorage.getItem("resentlyViewdProducts"))||[]}},components:{OrderNav:wt.Z,SwiperComponent:yt.Z},watch:{cartData:{handler(){this.final_total=Math.round(this.cartData.final_total)},deep:!0},final_total:{handler(){this.discount_price=this.final_total-this.cartData.total},deep:!0}},computed:{...(0,ht.rn)(gt.Z,["cartData","coupon_code"]),...(0,ht.rn)(vt.Z,["isLoading"])},methods:{...(0,ht.nv)(gt.Z,["getCartList","updateCart","delCartItem","addCouponCode"]),...(0,ht.nv)(vt.Z,["loadingEffect","pushMsg"]),isPhone(t){const a=/^(09)[0-9]{8}$/;return!!a.test(t)||"需要正確的電話號碼"},onSubmit(){0===this.cartData.carts.length?this.pushMsg(!1,"送出","購書車還是空的呢!"):this.$http.post("https://vue3-course-api.hexschool.io/v2/api/zy123/order",{data:this.form}).then((t=>{this.pushMsg(t,"送出","已成功送出訂單"),this.form.message="",this.getCartList(),this.$router.push(`/checkout/${t.data.orderId}`)})).catch((()=>{this.pushMsg(!1,"送出","送出訂單失敗")}))},getResentlyViewdProducts(){this.resentlyViewdProducts=JSON.parse(localStorage.getItem("resentlyViewdProducts"))||[]},clearRecentlyViewed(){this.loadingEffect(),localStorage.removeItem("resentlyViewdProducts"),this.getResentlyViewdProducts()}},mounted(){this.final_total=Math.round(this.cartData.final_total),this.discount_price=this.final_total-this.cartData.total}},kt=e(3744);const Dt=(0,kt.Z)(xt,[["render",_t],["__scopeId","data-v-39859e87"]]);var Ct=Dt}}]);
//# sourceMappingURL=349.62067d27.js.map