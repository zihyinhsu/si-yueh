(self["webpackChunksi_yueh"]=self["webpackChunksi_yueh"]||[]).push([[386],{2705:function(t,e,s){var i=s(5639),o=i.Symbol;t.exports=o},4239:function(t,e,s){var i=s(2705),o=s(9607),a=s(2333),n="[object Null]",c="[object Undefined]",r=i?i.toStringTag:void 0;function l(t){return null==t?void 0===t?c:n:r&&r in Object(t)?o(t):a(t)}t.exports=l},7561:function(t,e,s){var i=s(7990),o=/^\s+/;function a(t){return t?t.slice(0,i(t)+1).replace(o,""):t}t.exports=a},1957:function(t,e,s){var i="object"==typeof s.g&&s.g&&s.g.Object===Object&&s.g;t.exports=i},9607:function(t,e,s){var i=s(2705),o=Object.prototype,a=o.hasOwnProperty,n=o.toString,c=i?i.toStringTag:void 0;function r(t){var e=a.call(t,c),s=t[c];try{t[c]=void 0;var i=!0}catch(r){}var o=n.call(t);return i&&(e?t[c]=s:delete t[c]),o}t.exports=r},2333:function(t){var e=Object.prototype,s=e.toString;function i(t){return s.call(t)}t.exports=i},5639:function(t,e,s){var i=s(1957),o="object"==typeof self&&self&&self.Object===Object&&self,a=i||o||Function("return this")();t.exports=a},7990:function(t){var e=/\s/;function s(t){var s=t.length;while(s--&&e.test(t.charAt(s)));return s}t.exports=s},3279:function(t,e,s){var i=s(3218),o=s(7771),a=s(4841),n="Expected a function",c=Math.max,r=Math.min;function l(t,e,s){var l,d,u,p,h,g,m=0,f=!1,v=!1,y=!0;if("function"!=typeof t)throw new TypeError(n);function b(e){var s=l,i=d;return l=d=void 0,m=e,p=t.apply(i,s),p}function _(t){return m=t,h=setTimeout(C,e),f?b(t):p}function w(t){var s=t-g,i=t-m,o=e-s;return v?r(o,u-i):o}function x(t){var s=t-g,i=t-m;return void 0===g||s>=e||s<0||v&&i>=u}function C(){var t=o();if(x(t))return k(t);h=setTimeout(C,w(t))}function k(t){return h=void 0,y&&l?b(t):(l=d=void 0,p)}function L(){void 0!==h&&clearTimeout(h),m=0,l=g=d=h=void 0}function S(){return void 0===h?p:k(o())}function I(){var t=o(),s=x(t);if(l=arguments,d=this,g=t,s){if(void 0===h)return _(g);if(v)return clearTimeout(h),h=setTimeout(C,e),b(g)}return void 0===h&&(h=setTimeout(C,e)),p}return e=a(e)||0,i(s)&&(f=!!s.leading,v="maxWait"in s,u=v?c(a(s.maxWait)||0,e):u,y="trailing"in s?!!s.trailing:y),I.cancel=L,I.flush=S,I}t.exports=l},3218:function(t){function e(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}t.exports=e},7005:function(t){function e(t){return null!=t&&"object"==typeof t}t.exports=e},3448:function(t,e,s){var i=s(4239),o=s(7005),a="[object Symbol]";function n(t){return"symbol"==typeof t||o(t)&&i(t)==a}t.exports=n},7771:function(t,e,s){var i=s(5639),o=function(){return i.Date.now()};t.exports=o},4841:function(t,e,s){var i=s(7561),o=s(3218),a=s(3448),n=NaN,c=/^[-+]0x[0-9a-f]+$/i,r=/^0b[01]+$/i,l=/^0o[0-7]+$/i,d=parseInt;function u(t){if("number"==typeof t)return t;if(a(t))return n;if(o(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=o(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=i(t);var s=r.test(t);return s||l.test(t)?d(t.slice(2),s?2:8):c.test(t)?n:+t}t.exports=u},4677:function(t,e,s){"use strict";var i=s(9669),o=s.n(i),a=s(8262),n=s(3279),c=s.n(n),r=s(6294);const l=(0,r.Z)();e["Z"]=(0,a.Q_)("cartStore",{state:()=>({cartData:{carts:[],final_total:""},coupon_code:""}),actions:{getCartList(){l.isBounced=!0,o().get("https://vue3-course-api.hexschool.io/v2/api/zy123/cart").then((t=>{this.cartData=t.data.data,l.isBounced=!1})).catch((()=>{l.pushMsg(!1,"載入","請重新整理")}))},updateCart(t,e=1){t.qty<=1?t.qty=1:t.qty>=t.product.inventory&&(t.qty=t.product.inventory),o().put(`https://vue3-course-api.hexschool.io/v2/api/zy123/cart/${t.id}`,{data:{product_id:t.product.id,qty:Number(t.qty)}}).then((t=>{this.getCartList(),l.pushMsg(t,"更新","已成功更新購書車")})).catch((()=>{l.pushMsg(!1,"更新","更新購書車失敗")}))},delCartItem(t){o()["delete"](`https://vue3-course-api.hexschool.io/v2/api/zy123/cart/${t.id}`).then((t=>{this.getCartList(),l.pushMsg(t,"刪除","已成功刪除品項")})).catch((()=>{l.pushMsg(!1,"刪除","刪除品項失敗")}))},delAllCart(t){l.isLoadingItem=t.id,o()["delete"]("https://vue3-course-api.hexschool.io/v2/api/zy123/carts").then((t=>{l.isLoadingItem="",this.getCartList(),l.pushMsg(t,"刪除","已成功刪除所有品項")})).catch((()=>{l.isLoadingItem="",l.pushMsg(!1,"刪除","刪除所有品項失敗")}))},addToCart:c()((function(t,e=1){l.isLoadingItem=t.id;let s=this.cartData.carts.filter((e=>e.product_id===t.id));s={...s[0]};const i=s.qty+e;i>t.inventory?(l.pushMsg(!1,"加入","超過庫存數量"),l.isLoadingItem=""):o().post("https://vue3-course-api.hexschool.io/v2/api/zy123/cart",{data:{product_id:t.id,qty:e}}).then((t=>{this.getCartList(),l.pushMsg(t,"加入","已成功加入購書車"),l.isLoadingItem=""})).catch((()=>{l.pushMsg(!1,"加入","加入購書車失敗")}))}),500),addCouponCode(){""===this.coupon_code?l.pushMsg(!1,"套用","你還沒填入優惠碼呢"):o().post("https://vue3-course-api.hexschool.io/v2/api/zy123/coupon",{data:{code:this.coupon_code}}).then((t=>{this.getCartList(),l.pushMsg(t,"套用","已套用優惠券")})).catch((()=>{l.pushMsg(!1,"套用","套用優惠券失敗")}))},copyCouponCode(t){navigator.clipboard.writeText(t).then((()=>{l.pushMsg(!0,"複製","您已成功複製優惠碼!"),this.coupon_code=t}))}}})},6294:function(t,e,s){"use strict";var i=s(8262);e["Z"]=(0,i.Q_)("statusStore",{state:()=>({isLoadingItem:"",isLoading:!1,isBounced:!1,messages:[],message:{}}),actions:{loadingEffect(){this.isLoading=!0,setTimeout((()=>{this.isLoading=!1}),1e3)},loadingItemEffect(){this.isLoadingItem=!0,setTimeout((()=>{this.isLoadingItem=!1}),1e3)},toastShow(){setTimeout((()=>{this.messages.shift()}),1500)},clearToast(t){this.messages.splice(t,1)},pushMsg(t=!0,e="更新",s){this.message=t?{style:"primary",title:`${e}成功`,content:s,icon:"fa-circle-check"}:{style:"danger",title:`${e}失敗`,content:s,icon:"fa-circle-xmark"},this.statusMsg(this.message)},statusMsg(t){const{style:e,title:s,content:i,icon:o}=t;this.messages.push({style:e,title:s,content:i,icon:o}),this.toastShow()}}})},6614:function(t,e,s){"use strict";s.d(e,{Z:function(){return v}});var i=s(6252),o=s(3577),a=s(9963);const n={"aria-label":"Page navigation"},c={class:"pagination d-flex align-items-center"},r=(0,i._)("span",{"aria-hidden":"true"},"«",-1),l=[r],d=["onClick"],u=(0,i._)("span",{"aria-hidden":"true"},"»",-1),p=[u];function h(t,e,s,r,u,h){return(0,i.wg)(),(0,i.iD)("nav",n,[(0,i._)("ul",c,[(0,i._)("li",{class:(0,o.C_)(["page-item",{disabled:!s.pages.has_pre}])},[(0,i._)("a",{class:"page-link",href:"#","aria-label":"Previous",onClick:e[0]||(e[0]=(0,a.iM)((e=>(t.$emit("update-page",s.pages.category,s.pages.current_page-1),h.goTop())),["prevent"]))},l)],2),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(s.pages.total_pages,((e,n)=>((0,i.wg)(),(0,i.iD)("li",{class:(0,o.C_)(["page-item",{active:e===s.pages.current_page}]),key:n},[(0,i._)("a",{class:(0,o.C_)(["page-link",{"pointer-none":e===s.pages.current_page}]),href:"#",onClick:(0,a.iM)((i=>(t.$emit("update-page",s.pages.category,e),h.goTop())),["prevent"])},(0,o.zw)(e),11,d)],2)))),128)),(0,i._)("li",{class:(0,o.C_)(["page-item",{disabled:!s.pages.has_next}])},[(0,i._)("a",{class:"page-link",href:"#","aria-label":"Next",onClick:e[1]||(e[1]=(0,a.iM)((e=>(t.$emit("update-page",s.pages.category,s.pages.current_page+1),h.goTop())),["prevent"]))},p)],2)])])}var g={props:["pages"],methods:{goTop(){document.documentElement.scrollTop=0}}},m=s(3744);const f=(0,m.Z)(g,[["render",h]]);var v=f},4386:function(t,e,s){"use strict";s.r(e),s.d(e,{default:function(){return st}});var i=s(6252),o=s(9963),a=s(3577),n=s(9163);const c=t=>((0,i.dD)("data-v-70093220"),t=t(),(0,i.Cn)(),t),r=c((()=>(0,i._)("img",{src:n,alt:"Loading"},null,-1))),l={class:"bg-light window-height"},d={class:"container"},u={class:"row py-6 py-md-7"},p={class:"col d-flex flex-column flex-md-row justify-content-md-between"},h={class:"autocomplete-container position-relative w-100 mb-4 mb-md-0"},g={class:"input-group w-md-50 me-2"},m=c((()=>(0,i._)("i",{class:"fa-solid fa-magnifying-glass text-white"},null,-1))),f=[m],v={class:"input d-flex align-items-center border border-dark cursor-pointer"},y=c((()=>(0,i._)("span",{class:"px-2 text-dark"},"▼",-1))),b={key:0,class:"selectList position-absolute box-shadow bg-white w-100 z-index-2"},_=["onClick"],w={class:"col-md-3 mb-5 mb-md-0"},x={class:"position-sticky top-20"},C={class:"accordion",id:"accordion"},k={class:"accordion-item border-0"},L=c((()=>(0,i._)("h2",{class:"accordion-header",id:"panelsStayOpen-headingOne"},[(0,i._)("button",{class:"accordion-button text-white bg-primaryDark fs-4 fs-md-3 fw-bold px-3 py-4 px-md-4 py-md-5",type:"button","data-bs-toggle":"collapse","data-bs-target":"#panelsStayOpen-collapseOne","aria-expanded":"true","aria-controls":"panelsStayOpen-collapseOne"},"類別")],-1))),S={id:"panelsStayOpen-collapseOne",class:"accordion-collapse collapse","aria-labelledby":"panelsStayOpen-headingOne"},I={class:"accordion-body p-0"},M={class:"list-group list-group-flush fw-bold cursor-pointer"},T=["onClick"],O={class:"col-md-9"},D={key:0,class:"fs-3 fw-bold vh-40 vh-md-50 py-4 w-100"},P={class:"d-flex align-items-center w-100 p-3 p-md-5 h-100"},z=["src","alt"],$={class:"bookIntro border-end-md pe-md-1 w-57.5 w-md-45 me-md-4"},j={class:"fs-small fs-md-5 mb-1 mb-md-2"},A={class:"fs-small fs-md-5 mb-1 mb-md-2"},E={class:"fs-small fs-md-5 mb-1 mb-md-2"},q={class:"fs-md-3 fw-bold text-primary mb-1 mb-md-2"},V=["onClick"],Z=c((()=>(0,i._)("i",{class:"fa-solid fa-cart-plus me-3"},null,-1))),H=(0,i.Uk)("加入購書車"),N=c((()=>(0,i._)("i",{class:"fas fa-spinner fa-pulse ms-1"},null,-1))),U=[N],B={class:"bookContent w-55 d-none d-md-block"},W=["innerHTML"],K={class:"text-end mt-2"},Y=(0,i.Uk)("繼續閱讀");function F(t,e,s,n,c,m){const N=(0,i.up)("LoadingView"),F=(0,i.up)("router-link"),Q=(0,i.up)("PagiNation");return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i.Wm)(N,{class:"loading",active:c.isLoading},{default:(0,i.w5)((()=>[r])),_:1},8,["active"]),(0,i._)("div",l,[(0,i._)("div",d,[(0,i._)("div",u,[(0,i._)("div",p,[(0,i._)("form",h,[(0,i._)("div",g,[(0,i.wy)((0,i._)("input",{class:"form-control",type:"search","onUpdate:modelValue":e[0]||(e[0]=t=>c.search=t),onKeyup:e[1]||(e[1]=(...t)=>m.keyboardEvent&&m.keyboardEvent(...t)),placeholder:"輸入書籍、作者名稱","aria-label":"Search","aria-describedby":"button-addon2"},null,544),[[o.nr,c.search,void 0,{trim:!0}]]),(0,i._)("button",{class:(0,a.C_)(["btn btn-primary",{disabled:""===c.search}]),type:"submit",id:"button-addon2",onClick:e[2]||(e[2]=(...t)=>m.searchProducts&&m.searchProducts(...t))},f,2)]),(0,i._)("ul",{class:(0,a.C_)(["autoComplete position-absolute box-shadow bg-white w-100 w-md-50 z-index-3",c.autoComplete?"":"d-none"])},[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(m.filterProducts,((t,e)=>((0,i.wg)(),(0,i.iD)("li",{class:(0,a.C_)(["listHover p-2 w-100",c.selectedIndex===e?"bg-light":""]),key:t.id},[(0,i.Wm)(F,{class:"text-dark d-inline-block w-100",to:`/product/${t.id}`},{default:(0,i.w5)((()=>[(0,i.Uk)((0,a.zw)(t.title),1)])),_:2},1032,["to"])],2)))),128))],2)]),(0,i._)("form",{class:"select position-relative",onClick:e[4]||(e[4]=t=>this.selectShow=!this.selectShow)},[(0,i._)("div",v,[(0,i.wy)((0,i._)("input",{class:"form-control border-none cursor-pointer box-shadow-none",type:"text","onUpdate:modelValue":e[3]||(e[3]=t=>c.selectOption=t),placeholder:"簡易篩選",readonly:""},null,512),[[o.nr,c.selectOption]]),y]),c.selectShow?((0,i.wg)(),(0,i.iD)("ul",b,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(c.selectList,((t,e)=>((0,i.wg)(),(0,i.iD)("li",{class:"listHover p-2",key:e,onClick:e=>m.getSelectValue(t)},(0,a.zw)(t.option),9,_)))),128))])):(0,i.kq)("",!0)])])]),(0,i._)("div",{class:(0,a.C_)(["row",{"vh-md-60":c.products.length<=1}])},[(0,i._)("div",w,[(0,i._)("div",x,[(0,i._)("div",C,[(0,i._)("div",k,[L,(0,i._)("div",S,[(0,i._)("div",I,[(0,i._)("ul",M,[(0,i._)("li",{class:(0,a.C_)(["list-group-item","all"===c.isActive?"active":""]),onClick:e[5]||(e[5]=t=>(m.getProducts(),c.isActive="all",m.accordionCollapseBack()))},"全部 ("+(0,a.zw)(c.productsAll.length)+")",3),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(m.filterCategory,((t,e)=>((0,i.wg)(),(0,i.iD)("li",{class:(0,a.C_)(["list-group-item cateList",c.isActive===t?"active":""]),key:e,onClick:e=>(m.getProducts(t),c.isActive=t,m.accordionCollapseBack())},(0,a.zw)(t)+" ("+(0,a.zw)(m.filterCateNum[t])+")",11,T)))),128))])])])])])])]),(0,i._)("div",O,[(0,i._)("ul",{class:(0,a.C_)({"vh-50":1===c.products.length})},[0===c.products.length?((0,i.wg)(),(0,i.iD)("p",D,"沒有相符的搜尋結果 Σ( ° △ °)")):(0,i.kq)("",!0),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(c.products,(e=>((0,i.wg)(),(0,i.iD)("li",{class:(0,a.C_)(["bg-white mb-4 mb-md-8 hoverBoxShadow",0===c.products.length?"d-none":""]),key:e.id},[(0,i._)("div",P,[(0,i.Wm)(F,{class:"text-primary me-4 me-md-5 w-42.5 w-md-30",to:`/product/${e.id}`},{default:(0,i.w5)((()=>[(0,i._)("img",{class:"ratio ratio-3x4 rounded-4",src:e.imageUrl,alt:e.title},null,8,z)])),_:2},1032,["to"]),(0,i._)("div",$,[(0,i.Wm)(F,{class:"text-primaryDark fw-bold fs-md-4 mb-1 mb-md-2",to:`/product/${e.id}`},{default:(0,i.w5)((()=>[(0,i.Uk)((0,a.zw)(e.title),1)])),_:2},1032,["to"]),(0,i._)("p",j,"作者 : "+(0,a.zw)(e.author),1),(0,i._)("p",A,"出版社 : "+(0,a.zw)(e.publishing_house),1),(0,i._)("p",E,"出版日期 : "+(0,a.zw)(e.publication_date),1),(0,i._)("p",q,"NT$ "+(0,a.zw)(e.price),1),(0,i._)("div",{class:"btn btn-primary text-white w-md-auto fs-small fs-md-5",onClick:s=>t.addToCart(e)},[Z,H,(0,i.wy)((0,i._)("span",null,U,512),[[o.F8,t.isLoadingItem===e.id]])],8,V)]),(0,i._)("div",B,[(0,i._)("p",{innerHTML:e.content},null,8,W),(0,i._)("div",K,[(0,i.Wm)(F,{class:"text-primary w-100",to:`/product/${e.id}`},{default:(0,i.w5)((()=>[Y])),_:2},1032,["to"])])])])],2)))),128))],2),0!==c.products.length?((0,i.wg)(),(0,i.j4)(Q,{key:0,class:"d-flex justify-content-center mb-4 mb-md-6",pages:c.pagination,onUpdatePage:m.getProducts},null,8,["pages","onUpdatePage"])):(0,i.kq)("",!0)])],2)])])],64)}var Q=s(6614),G=s(8262),J=s(4677),R=s(6294),X={data(){return{products:[],productsAll:[],pagination:{category:""},isActive:"all",isLoading:"",selectedIndex:-1,search:"",autoComplete:!1,selectValue:"",selectOption:"",selectList:[{option:"年份 : 由新到舊",value:"publication_date"},{option:"價格 : 由高至低",value:"price"}],selectShow:!1}},components:{PagiNation:Q.Z},methods:{...(0,G.nv)(J.Z,["addToCart"]),...(0,G.nv)(R.Z,["pushMsg"]),getProducts(t,e=1){let s=`https://vue3-course-api.hexschool.io/v2/api/zy123/products?page=${e}`;t&&(s=`https://vue3-course-api.hexschool.io/v2/api/zy123/products?category=${t}&page=${e}`),this.isLoading=!0,this.$http.get(s).then((t=>{this.products=t.data.products,this.pagination=t.data.pagination,this.isLoading=!1,this.selectOption="",this.search="",this.selectValue=""})).catch((()=>{this.isLoading=!1}))},getAllProducts(){this.$http.get("https://vue3-course-api.hexschool.io/v2/api/zy123/products/all").then((t=>{this.productsAll=t.data.products})).catch((()=>{this.pushMsg(!1,"載入","請重新整理")}))},accordionCollapseBack(){if(window.matchMedia("(max-width: 767px)").matches){const t=document.querySelector(".accordion-button");t.click()}},sortByDate(){this.selectValue&&this.products.sort(((t,e)=>e[this.selectValue]>t[this.selectValue]?1:-1))},searchProducts(){this.products=this.filterProducts,this.autoComplete=!1},keyboardEvent(t){if(38===t.keyCode)0!==this.selectedIndex&&this.selectedIndex--;else if(40===t.keyCode){const t=this.filterProducts.length-1;this.selectedIndex!==t&&this.selectedIndex++}else 13===t.keyCode&&this.filterProducts.forEach(((t,e)=>{this.selectedIndex===e&&(this.search=t.title,this.searchProducts())}))},getSelectValue(t){this.selectOption=t.option,this.selectValue=t.value}},watch:{search(){this.search?(this.autoComplete=!0,this.pagination.current_page=1,this.pagination.total_pages=1,this.pagination.has_next=!1):(this.autoComplete=!1,this.selectedIndex=-1)},selectValue:{handler(){this.sortByDate()},deep:!0},products(){this.products.length<=1&&(this.autoComplete=!1),this.products.forEach((t=>{t.publication_date=t.publication_date.split("-").join("/")}))}},computed:{...(0,G.rn)(J.Z,["cartData"]),...(0,G.rn)(R.Z,["isLoadingItem"]),filterProducts(){const t=this.search.split(" "),e=[];return t.forEach((t=>{this.productsAll.forEach((s=>{(s.title.includes(t)||s.author.includes(t))&&e.push(s)}))})),[...new Set(e)]},filterCategory(){const t=this.productsAll.map((t=>t.category));return[...new Set(t)]},filterCateNum(){const t={};return this.productsAll.forEach((e=>{t[e.category]?t[e.category]+=1:t[e.category]=1})),t}},mounted(){this.getAllProducts(),this.getProducts(),setTimeout((()=>{const t=localStorage.getItem("category"),e=localStorage.getItem("isActive")||"all";t&&(this.isActive=e,this.getProducts(t),localStorage.removeItem("category"),localStorage.removeItem("isActive"))}),500)}},tt=s(3744);const et=(0,tt.Z)(X,[["render",F],["__scopeId","data-v-70093220"]]);var st=et},9163:function(t,e,s){"use strict";t.exports=s.p+"img/loading.8a13cb6e.gif"}}]);
//# sourceMappingURL=386.14ff2736.js.map